module.exports = {
    root: true,
    plugins: [
        'import',
        'jsdoc',
        'node',
        'promise',
        'sonarjs',
        'unicorn',
        '@typescript-eslint',
    ],
    extends: [
        'eslint:recommended',
        'plugin:import/recommended',
        'plugin:import/typescript',
        'plugin:node/recommended',
        'plugin:unicorn/recommended',
        'plugin:@typescript-eslint/eslint-recommended',
        'plugin:@typescript-eslint/recommended',
        'eslint-plugin-header',
        'prettier',
    ],
    env: {
        mocha: true,
        node: true,
        es6: true,
    },
    globals: {
        BigInt: true,
    },
    parserOptions: {
        sourceType: 'module',
        ecmaVersion: 2020,
    },
    settings: {
        node: {
            tryExtensions: ['.js', '.ts'],
        },
        'imports/parsers': {
            '@typescript-eslint/parser': ['.ts'],
        },
        'import/resolver': 'typescript',
    },
    rules: {
        // Default ESLint rules
        'comma-dangle': ['error', 'always-multiline'],
        'eol-last': ['error', 'always'],
        eqeqeq: ['error', 'always'],
        'max-len': ['error', 120, {ignoreRegExpLiterals: true}],
        'max-statements': ['error', 100],
        'no-control-regex': 0,
        'no-duplicate-imports': 'error',
        'no-useless-call': 'error',
        'no-useless-computed-key': 'error',
        'no-useless-concat': 'error',
        'no-useless-constructor': 'error',
        'no-useless-escape': 'error',
        'no-useless-rename': 'error',
        'no-useless-return': 'error',
        'quote-props': ['error', 'as-needed'],
        'quotes': ['error', 'single', {allowTemplateLiterals: true, avoidEscape: true}],
        'semi': ['error', 'always'],
        'space-before-function-paren': ['error', {anonymous: 'always', asyncArrow: 'always', named: 'never'}],
        'keyword-spacing': ['error', {after: true}],
        'yoda': ['error', 'never', {onlyEquality: true}],
        'no-multiple-empty-lines': ['warn', {max: 1, maxBOF: 0, maxEOF: 0}],
        'no-process-exit': 'off',
        'sort-imports': ['warn', {ignoreCase: true, ignoreDeclarationSort: true}],
        // Import plugin
        'import/default': 'off',
        'import/extensions': 'error',
        'import/first': 'error',
        'import/newline-after-import': 'error',
        'import/no-absolute-path': 'error',
        'import/no-cycle': 'error',
        'import/no-default-export': 'warn',
        'import/no-deprecated': 'warn',
        'import/no-mutable-exports': 'error',
        'import/no-named-as-default-member': 'off',
        'import/no-self-import': 'error',
        'import/no-useless-path-segments': 'error',
        'import/no-webpack-loader-syntax': 'error',
        'import/order': [
            'warn',
            {
                'alphabetize': {
                    'order': 'asc',
                    'caseInsensitive': true,
                },
                'newlines-between': 'always',
            },
        ],
        // JSDoc plugin
        'jsdoc/check-alignment': 'warn',
        'jsdoc/check-param-names': 'warn',
        'jsdoc/check-syntax': 'warn',
        'jsdoc/check-tag-names': 'off',
        'jsdoc/check-types': 'warn',
        'jsdoc/empty-tags': 'warn',
        'jsdoc/newline-after-description': 'warn',
        'jsdoc/require-hyphen-before-param-description': 'warn',
        'jsdoc/valid-types': 'warn',
        // Node plugin
        'node/no-unsupported-features/es-syntax': 'off',
        'node/shebang': 'off',
        // Promise plugin
        'promise/catch-or-return': 'error',
        'promise/no-new-statics': 'error',
        'promise/no-return-wrap': 'error',
        'promise/param-names': 'error',
        'promise/valid-params': 'error',
        // SonarJS plugin
        'sonarjs/no-collection-size-mischeck': 'error',
        'sonarjs/no-redundant-boolean': 'error',
        'sonarjs/no-unused-collection': 'error',
        'sonarjs/prefer-immediate-return': 'error',
        'sonarjs/prefer-object-literal': 'error',
        'sonarjs/prefer-single-boolean-return': 'error',
        // Unicorn plugin
        'unicorn/catch-error-name': 'off',
        'unicorn/consistent-function-scoping': 'off',
        'unicorn/empty-brace-spaces': 'off',
        'unicorn/no-fn-reference-in-iterator': 'off',
        'unicorn/no-hex-escape': 'off',
        'unicorn/no-null': 'off',
        'unicorn/no-reduce': 'off',
        'unicorn/numeric-separators-style': 'off',
        'unicorn/prefer-add-event-listener': 'off',
        'unicorn/prefer-flat-map': 'error',
        'unicorn/prefer-optional-catch-binding': 'off',
        'unicorn/prefer-node-protocol': 'off',
        'unicorn/prefer-number-properties': 'off',
        'unicorn/prefer-string-slice': 'off',
        'unicorn/prevent-abbreviations': 'off',
        'unicorn/prefer-ternary': 'off',
        'unicorn/prefer-array-some': 'off',
        'unicorn/prefer-spread': 'off',
        'unicorn/no-lonely-if': 'off',
        'unicorn/no-array-reduce': 'off',
        'unicorn/prefer-array-flat': 'off',
        'unicorn/no-array-callback-reference': 'off',
        'unicorn/prefer-switch': 'off',
        'unicorn/no-static-only-class': 'off',
        'unicorn/no-process-exit': 'off',
        // Typescript ESLint plugin
        '@typescript-eslint/no-empty-function': 'off',
        '@typescript-eslint/no-unused-vars': 'off',
        '@typescript-eslint/no-explicit-any': 'off',
        // ESLint Header plugin
        'header/header': [
            'off',
            'line',
            [
                {
                    'pattern': '^ Copyright \\(c\\) \\d{4}, .*$',
                    'template': ' Copyright (c) 2021, Compiler Explorer Authors',
                },
                ' All rights reserved.',
                '',
                ' Redistribution and use in source and binary forms, with or without',
                ' modification, are permitted provided that the following conditions are met:',
                '',
                '     * Redistributions of source code must retain the above copyright notice,',
                '       this list of conditions and the following disclaimer.',
                '     * Redistributions in binary form must reproduce the above copyright',
                '       notice, this list of conditions and the following disclaimer in the',
                '       documentation and/or other materials provided with the distribution.',
                '',
                ' THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"',
                ' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE',
                ' IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE',
                ' ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE',
                ' LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR',
                ' CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF',
                ' SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS',
                ' INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN',
                ' CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)',
                ' ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE',
                ' POSSIBILITY OF SUCH DAMAGE.',
            ],
            2,
        ],
    },
};
